# ğŸ“‰ ChurnSense â€” Telecom Customer Churn Prediction

> **Author:** Aditya Mahale  
> **Tech Stack:** Python Â· Pandas Â· NumPy Â· Scikit-learn Â· Matplotlib Â· Seaborn Â· SQL Â· FastAPI Â· Streamlit Â· Docker

---

## ğŸ¯ Project Overview

An end-to-end machine learning pipeline that predicts customer churn for a telecom company using the [IBM Telco Customer Churn dataset](https://www.kaggle.com/datasets/blastchar/telco-customer-churn).

Starting from raw customer data, this project covers the full data science lifecycle:

- **EDA** â€” uncovering churn patterns across tenure, contract type, and charges
- **Feature Engineering** â€” derived features that capture customer lifecycle signals
- **Modeling** â€” comparing Logistic Regression and Random Forest via Stratified K-Fold CV
- **Explainability** â€” SHAP values to understand *why* a customer is predicted to churn
- **Deployment** â€” FastAPI REST endpoint + Streamlit interactive dashboard
- **Monitoring** â€” automated drift detection and performance logging
- **SQL Analysis** â€” segment-wise retention and churn metrics for marketing decisions
- **Docker** â€” fully containerised with `docker-compose`

---

## ğŸ“Š Key Findings

| Segment | Churn Rate |
|---|---|
| Month-to-month contracts | ~43% |
| Fiber optic users | ~42% |
| No tech support | ~41% |
| Two-year contracts | ~12% |
| Customers with tech support | ~15% |

**Overall churn rate:** ~26.5%

---

## ğŸ¤– Model Results

| Model | F1-Score | AUC-ROC |
|---|---|---|
| **Logistic Regression** âœ… | **0.625** | **0.846** |
| Random Forest | 0.616 | 0.835 |

Logistic Regression selected as production model (highest F1). Random Forest used for SHAP explainability (TreeExplainer).

---

## ğŸ—‚ï¸ Project Structure

```
ChurnSense/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ feature_engineering.py   # Shared feature pipeline
â”‚   â””â”€â”€ cleaned_churn_data.csv   # Generated by model.py (gitignored)
â”œâ”€â”€ models/                      # Saved .pkl files (gitignored)
â”œâ”€â”€ monitoring/                  # Performance logs & drift alerts
â”œâ”€â”€ reports/figures/             # SHAP plots, EDA charts
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app.py                   # FastAPI prediction API
â”‚   â”œâ”€â”€ monitoring.py            # ModelMonitor class
â”‚   â””â”€â”€ run_monitoring.py        # Scheduled monitoring runner
â”œâ”€â”€ analysis.sql                 # SQL churn segment analysis
â”œâ”€â”€ dashboard.py                 # Streamlit interactive dashboard
â”œâ”€â”€ model.py                     # Training pipeline (run this first)
â”œâ”€â”€ model_evaluator.py           # Evaluation utility
â”œâ”€â”€ Dockerfile.api               # Docker image for FastAPI
â”œâ”€â”€ Dockerfile.dashboard         # Docker image for Streamlit
â”œâ”€â”€ docker-compose.yml           # Orchestrate both services
â”œâ”€â”€ requirements.txt
â””â”€â”€ .gitignore
```

---

## âš™ï¸ Setup & Installation

```bash
# 1. Clone
git clone https://github.com/AdityaM24/churnsense.git
cd churnsense

# 2. Create virtual environment
python -m venv venv
source venv/bin/activate        # Windows: venv\Scripts\activate

# 3. Install dependencies
pip install -r requirements.txt

# 4. Train the model (downloads dataset, saves model + SHAP explainer)
python model.py
```

---

## ğŸš¦ Usage

### Option A â€” Local

```bash
# FastAPI backend
uvicorn src.app:app --reload

# Streamlit dashboard (new terminal)
streamlit run dashboard.py

# Run monitoring
python src/run_monitoring.py
```

### Option B â€” Docker (recommended)

```bash
# Build & start both services
docker-compose up --build

# API  â†’ http://localhost:8000
# Docs â†’ http://localhost:8000/docs
# Dashboard â†’ http://localhost:8501
```

---

## ğŸ” SHAP Explainability

Every prediction comes with a SHAP waterfall chart showing which features drove the result â€” making the model transparent and actionable for retention teams.

![SHAP Summary](reports/figures/shap_summary.png)

---

## ğŸ—„ï¸ SQL Analysis

`analysis.sql` contains 8 queries covering:
- Overall churn rate
- Churn by contract type, internet service, tenure stage, payment method
- High-risk segment identification
- CRM retention targeting (proactive intervention list)

Run these against the processed data loaded into any SQL database (SQLite, PostgreSQL, etc.).

---

## ğŸ”„ Monitoring

The `ModelMonitor` class logs F1 and AUC-ROC over time and raises alerts when performance degrades >15% relative to the baseline â€” simulating production model health monitoring.

---

## ğŸƒ Workflow

```
model.py â†’ cleaned_churn_data.csv + best_model.pkl + shap_explainer.pkl
    â†“
src/app.py   â†’  REST API  (POST /predict)
dashboard.py â†’  Web UI    (EDA + live prediction + SHAP chart)
analysis.sql â†’  SQL insights for marketing team
src/run_monitoring.py â†’  Scheduled drift checks
```

---

*Built by Aditya Mahale | Dataset: IBM Telco Customer Churn (Kaggle)*
